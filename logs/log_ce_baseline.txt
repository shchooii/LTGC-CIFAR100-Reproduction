[INFO] Using device: cuda
[INFO] data_dir   = data/CIFAR100_LT
[INFO] train_txt  = ./data_txt/CIFAR100_LT/CIFAR100_LT_train.txt
[INFO] test_txt   = ./data_txt/CIFAR100_LT/CIFAR100_LT_test.txt
[INFO] use_generated = False
[INFO] gen_dir    = None
[INFO] loss       = ce
[INFO] save_path  = ckpt_ce_baseline.pth
[INFO] #train=10847, #test=10000
[INFO] #classes=100
[INFO] cls_num_list (first 10): [500, 477, 455, 434, 415, 396, 378, 361, 344, 328]
[HMT] head   : 0 ~ 39  (#=40)
[HMT] medium : 40 ~ 69  (#=30)
[HMT] tail   : 70 ~ 99  (#=30)

=== Epoch 1/30 | lr = 0.10000 ===
[Train] Loss: 3.9839 | Acc@1: 9.52%
[Test ] Loss: 5.1310 | Acc@1: 4.05%
[INFO] New best Acc@1: 4.05% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 2/30 | lr = 0.10000 ===
[Train] Loss: 3.5827 | Acc@1: 14.57%
[Test ] Loss: 4.8905 | Acc@1: 6.03%
[INFO] New best Acc@1: 6.03% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 3/30 | lr = 0.10000 ===
[Train] Loss: 3.4514 | Acc@1: 16.84%
[Test ] Loss: 4.7047 | Acc@1: 7.24%
[INFO] New best Acc@1: 7.24% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 4/30 | lr = 0.10000 ===
[Train] Loss: 3.3753 | Acc@1: 18.53%
[Test ] Loss: 4.6734 | Acc@1: 7.98%
[INFO] New best Acc@1: 7.98% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 5/30 | lr = 0.10000 ===
[Train] Loss: 3.3074 | Acc@1: 19.76%
[Test ] Loss: 4.6184 | Acc@1: 9.02%
[INFO] New best Acc@1: 9.02% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 6/30 | lr = 0.10000 ===
[Train] Loss: 3.2563 | Acc@1: 20.54%
[Test ] Loss: 4.6552 | Acc@1: 8.71%

=== Epoch 7/30 | lr = 0.10000 ===
[Train] Loss: 3.1744 | Acc@1: 22.36%
[Test ] Loss: 4.5803 | Acc@1: 10.40%
[INFO] New best Acc@1: 10.40% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 8/30 | lr = 0.10000 ===
[Train] Loss: 3.0987 | Acc@1: 23.69%
[Test ] Loss: 4.6514 | Acc@1: 10.05%

=== Epoch 9/30 | lr = 0.10000 ===
[Train] Loss: 3.0537 | Acc@1: 24.79%
[Test ] Loss: 4.3369 | Acc@1: 11.81%
[INFO] New best Acc@1: 11.81% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 10/30 | lr = 0.10000 ===
[Train] Loss: 2.9836 | Acc@1: 26.14%
[Test ] Loss: 4.4540 | Acc@1: 12.93%
[INFO] New best Acc@1: 12.93% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 11/30 | lr = 0.10000 ===
[Train] Loss: 2.9529 | Acc@1: 26.29%
[Test ] Loss: 4.5636 | Acc@1: 12.01%

=== Epoch 12/30 | lr = 0.10000 ===
[Train] Loss: 2.8759 | Acc@1: 28.25%
[Test ] Loss: 4.3924 | Acc@1: 12.47%

=== Epoch 13/30 | lr = 0.10000 ===
[Train] Loss: 2.8262 | Acc@1: 29.33%
[Test ] Loss: 4.2167 | Acc@1: 14.11%
[INFO] New best Acc@1: 14.11% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 14/30 | lr = 0.10000 ===
[Train] Loss: 2.7675 | Acc@1: 30.57%
[Test ] Loss: 4.1754 | Acc@1: 15.27%
[INFO] New best Acc@1: 15.27% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 15/30 | lr = 0.10000 ===
[Train] Loss: 2.7094 | Acc@1: 31.28%
[Test ] Loss: 4.1849 | Acc@1: 14.94%

=== Epoch 16/30 | lr = 0.10000 ===
[Train] Loss: 2.6471 | Acc@1: 33.02%
[Test ] Loss: 4.2117 | Acc@1: 14.53%

=== Epoch 17/30 | lr = 0.10000 ===
[Train] Loss: 2.5856 | Acc@1: 34.33%
[Test ] Loss: 4.0534 | Acc@1: 16.17%
[INFO] New best Acc@1: 16.17% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 18/30 | lr = 0.10000 ===
[Train] Loss: 2.5447 | Acc@1: 35.45%
[Test ] Loss: 3.8555 | Acc@1: 18.88%
[INFO] New best Acc@1: 18.88% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 19/30 | lr = 0.10000 ===
[Train] Loss: 2.4577 | Acc@1: 36.89%
[Test ] Loss: 3.9657 | Acc@1: 17.39%

=== Epoch 20/30 | lr = 0.10000 ===
[Train] Loss: 2.4009 | Acc@1: 38.10%
[Test ] Loss: 3.8826 | Acc@1: 18.27%

=== Epoch 21/30 | lr = 0.10000 ===
[Train] Loss: 2.3827 | Acc@1: 38.43%
[Test ] Loss: 3.8563 | Acc@1: 19.03%
[INFO] New best Acc@1: 19.03% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 22/30 | lr = 0.10000 ===
[Train] Loss: 2.3042 | Acc@1: 40.42%
[Test ] Loss: 3.9206 | Acc@1: 20.26%
[INFO] New best Acc@1: 20.26% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 23/30 | lr = 0.10000 ===
[Train] Loss: 2.2485 | Acc@1: 41.63%
[Test ] Loss: 3.9463 | Acc@1: 18.98%

=== Epoch 24/30 | lr = 0.10000 ===
[Train] Loss: 2.2063 | Acc@1: 42.21%
[Test ] Loss: 3.7688 | Acc@1: 21.13%
[INFO] New best Acc@1: 21.13% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 25/30 | lr = 0.10000 ===
[Train] Loss: 2.1358 | Acc@1: 44.18%
[Test ] Loss: 3.8007 | Acc@1: 20.96%

=== Epoch 26/30 | lr = 0.10000 ===
[Train] Loss: 2.1172 | Acc@1: 44.69%
[Test ] Loss: 3.6591 | Acc@1: 23.05%
[INFO] New best Acc@1: 23.05% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 27/30 | lr = 0.10000 ===
[Train] Loss: 2.0387 | Acc@1: 46.67%
[Test ] Loss: 3.5421 | Acc@1: 24.07%
[INFO] New best Acc@1: 24.07% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 28/30 | lr = 0.10000 ===
[Train] Loss: 2.0135 | Acc@1: 46.69%
[Test ] Loss: 3.5651 | Acc@1: 24.18%
[INFO] New best Acc@1: 24.18% → checkpoint saved to ckpt_ce_baseline.pth

=== Epoch 29/30 | lr = 0.10000 ===
[Train] Loss: 1.9689 | Acc@1: 48.17%
[Test ] Loss: 3.8725 | Acc@1: 23.06%

=== Epoch 30/30 | lr = 0.10000 ===
[Train] Loss: 1.9390 | Acc@1: 48.95%
[Test ] Loss: 3.8458 | Acc@1: 23.06%

[RESULT] Best Test Acc@1: 24.18%

[INFO] Loading best checkpoint for group-wise evaluation...

[Group-wise Evaluation]
  total  | Acc:  24.18% | Micro-F1:  24.18% | Macro-F1:  19.80%
  head   | Acc:  43.95% | Micro-F1:  29.27% | Macro-F1:  31.79%
  medium | Acc:  20.87% | Micro-F1:  25.42% | Macro-F1:  21.69%
  tail   | Acc:   1.13% | Micro-F1:   2.22% | Macro-F1:   1.92%

[RESULT] Best Test Acc@1: 24.18%
