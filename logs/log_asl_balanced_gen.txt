[INFO] Using device: cuda
[INFO] data_dir   = data/CIFAR100_LT
[INFO] train_txt  = ./data_txt/CIFAR100_LT/CIFAR100_LT_train.txt
[INFO] test_txt   = ./data_txt/CIFAR100_LT/CIFAR100_LT_test.txt
[INFO] use_generated = True
[INFO] gen_dir    = data/CIFAR100_LT/gen_train
[INFO] loss       = asl
[INFO] save_path  = ckpt_asl_balanced_gen.pth
[INFO] Using generated data: base=10847, gen=2176, total=13023
[INFO] #train=13023, #test=10000
[INFO] #classes=100
[INFO] cls_num_list (first 10): [536, 543, 512, 485, 466, 449, 438, 415, 404, 375]
[HMT] head   : 0 ~ 39  (#=40)
[HMT] medium : 40 ~ 69  (#=30)
[HMT] tail   : 70 ~ 99  (#=30)

=== Epoch 1/30 | lr = 0.10000 ===
Epoch [1] Step [100/102] Loss: 2.4864 | Acc@1: 1.03%
[Train] Loss: 2.4743 | Acc@1: 1.03%
[Test ] Loss: 2.7666 | Acc@1: 0.97%
[INFO] New best Acc@1: 0.97% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 2/30 | lr = 0.10000 ===
Epoch [2] Step [100/102] Loss: 1.6814 | Acc@1: 1.49%
[Train] Loss: 1.6817 | Acc@1: 1.51%
[Test ] Loss: 1.4897 | Acc@1: 1.65%
[INFO] New best Acc@1: 1.65% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 3/30 | lr = 0.10000 ===
Epoch [3] Step [100/102] Loss: 1.6837 | Acc@1: 1.51%
[Train] Loss: 1.6827 | Acc@1: 1.53%
[Test ] Loss: 1.5634 | Acc@1: 1.42%

=== Epoch 4/30 | lr = 0.10000 ===
Epoch [4] Step [100/102] Loss: 1.6443 | Acc@1: 1.65%
[Train] Loss: 1.6441 | Acc@1: 1.64%
[Test ] Loss: 1.4759 | Acc@1: 1.21%

=== Epoch 5/30 | lr = 0.10000 ===
Epoch [5] Step [100/102] Loss: 1.8128 | Acc@1: 1.48%
[Train] Loss: 1.8094 | Acc@1: 1.48%
[Test ] Loss: 1.4708 | Acc@1: 1.90%
[INFO] New best Acc@1: 1.90% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 6/30 | lr = 0.10000 ===
Epoch [6] Step [100/102] Loss: 1.6476 | Acc@1: 1.82%
[Train] Loss: 1.6468 | Acc@1: 1.82%
[Test ] Loss: 1.6502 | Acc@1: 2.29%
[INFO] New best Acc@1: 2.29% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 7/30 | lr = 0.10000 ===
Epoch [7] Step [100/102] Loss: 1.6161 | Acc@1: 2.70%
[Train] Loss: 1.6154 | Acc@1: 2.73%
[Test ] Loss: 1.5631 | Acc@1: 2.91%
[INFO] New best Acc@1: 2.91% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 8/30 | lr = 0.10000 ===
Epoch [8] Step [100/102] Loss: 1.5729 | Acc@1: 3.49%
[Train] Loss: 1.5707 | Acc@1: 3.52%
[Test ] Loss: 1.4451 | Acc@1: 3.16%
[INFO] New best Acc@1: 3.16% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 9/30 | lr = 0.10000 ===
Epoch [9] Step [100/102] Loss: 1.4412 | Acc@1: 3.70%
[Train] Loss: 1.4408 | Acc@1: 3.73%
[Test ] Loss: 1.4462 | Acc@1: 3.11%

=== Epoch 10/30 | lr = 0.10000 ===
Epoch [10] Step [100/102] Loss: 1.4059 | Acc@1: 3.87%
[Train] Loss: 1.4055 | Acc@1: 3.89%
[Test ] Loss: 1.4278 | Acc@1: 4.50%
[INFO] New best Acc@1: 4.50% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 11/30 | lr = 0.10000 ===
Epoch [11] Step [100/102] Loss: 1.3900 | Acc@1: 4.81%
[Train] Loss: 1.3899 | Acc@1: 4.79%
[Test ] Loss: 1.4164 | Acc@1: 4.91%
[INFO] New best Acc@1: 4.91% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 12/30 | lr = 0.10000 ===
Epoch [12] Step [100/102] Loss: 1.3755 | Acc@1: 5.91%
[Train] Loss: 1.3757 | Acc@1: 5.91%
[Test ] Loss: 1.4017 | Acc@1: 5.35%
[INFO] New best Acc@1: 5.35% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 13/30 | lr = 0.10000 ===
Epoch [13] Step [100/102] Loss: 1.3595 | Acc@1: 7.42%
[Train] Loss: 1.3599 | Acc@1: 7.39%
[Test ] Loss: 1.3956 | Acc@1: 6.78%
[INFO] New best Acc@1: 6.78% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 14/30 | lr = 0.10000 ===
Epoch [14] Step [100/102] Loss: 1.3457 | Acc@1: 8.20%
[Train] Loss: 1.3457 | Acc@1: 8.19%
[Test ] Loss: 1.3757 | Acc@1: 7.28%
[INFO] New best Acc@1: 7.28% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 15/30 | lr = 0.10000 ===
Epoch [15] Step [100/102] Loss: 1.3309 | Acc@1: 9.70%
[Train] Loss: 1.3307 | Acc@1: 9.73%
[Test ] Loss: 1.3809 | Acc@1: 7.59%
[INFO] New best Acc@1: 7.59% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 16/30 | lr = 0.10000 ===
Epoch [16] Step [100/102] Loss: 1.3166 | Acc@1: 10.64%
[Train] Loss: 1.3167 | Acc@1: 10.60%
[Test ] Loss: 1.3763 | Acc@1: 7.60%
[INFO] New best Acc@1: 7.60% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 17/30 | lr = 0.10000 ===
Epoch [17] Step [100/102] Loss: 1.3019 | Acc@1: 12.20%
[Train] Loss: 1.3018 | Acc@1: 12.21%
[Test ] Loss: 1.3687 | Acc@1: 8.49%
[INFO] New best Acc@1: 8.49% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 18/30 | lr = 0.10000 ===
Epoch [18] Step [100/102] Loss: 1.2901 | Acc@1: 13.37%
[Train] Loss: 1.2899 | Acc@1: 13.38%
[Test ] Loss: 1.3883 | Acc@1: 8.09%

=== Epoch 19/30 | lr = 0.10000 ===
Epoch [19] Step [100/102] Loss: 1.2814 | Acc@1: 14.52%
[Train] Loss: 1.2816 | Acc@1: 14.51%
[Test ] Loss: 1.3653 | Acc@1: 9.31%
[INFO] New best Acc@1: 9.31% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 20/30 | lr = 0.10000 ===
Epoch [20] Step [100/102] Loss: 1.2642 | Acc@1: 16.33%
[Train] Loss: 1.2647 | Acc@1: 16.28%
[Test ] Loss: 1.3662 | Acc@1: 9.74%
[INFO] New best Acc@1: 9.74% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 21/30 | lr = 0.10000 ===
Epoch [21] Step [100/102] Loss: 1.2533 | Acc@1: 17.11%
[Train] Loss: 1.2531 | Acc@1: 17.12%
[Test ] Loss: 1.3734 | Acc@1: 9.22%

=== Epoch 22/30 | lr = 0.10000 ===
Epoch [22] Step [100/102] Loss: 1.2394 | Acc@1: 19.20%
[Train] Loss: 1.2394 | Acc@1: 19.22%
[Test ] Loss: 1.3694 | Acc@1: 10.41%
[INFO] New best Acc@1: 10.41% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 23/30 | lr = 0.10000 ===
Epoch [23] Step [100/102] Loss: 1.2175 | Acc@1: 21.88%
[Train] Loss: 1.2173 | Acc@1: 21.86%
[Test ] Loss: 1.3653 | Acc@1: 11.62%
[INFO] New best Acc@1: 11.62% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 24/30 | lr = 0.10000 ===
Epoch [24] Step [100/102] Loss: 1.2005 | Acc@1: 23.20%
[Train] Loss: 1.2006 | Acc@1: 23.12%
[Test ] Loss: 1.4176 | Acc@1: 11.06%

=== Epoch 25/30 | lr = 0.10000 ===
Epoch [25] Step [100/102] Loss: 1.1828 | Acc@1: 24.83%
[Train] Loss: 1.1826 | Acc@1: 24.81%
[Test ] Loss: 1.4065 | Acc@1: 11.73%
[INFO] New best Acc@1: 11.73% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 26/30 | lr = 0.10000 ===
Epoch [26] Step [100/102] Loss: 1.1573 | Acc@1: 27.08%
[Train] Loss: 1.1573 | Acc@1: 27.04%
[Test ] Loss: 1.3864 | Acc@1: 13.09%
[INFO] New best Acc@1: 13.09% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 27/30 | lr = 0.10000 ===
Epoch [27] Step [100/102] Loss: 1.1341 | Acc@1: 29.22%
[Train] Loss: 1.1334 | Acc@1: 29.26%
[Test ] Loss: 1.3975 | Acc@1: 13.12%
[INFO] New best Acc@1: 13.12% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 28/30 | lr = 0.10000 ===
Epoch [28] Step [100/102] Loss: 1.1088 | Acc@1: 32.02%
[Train] Loss: 1.1087 | Acc@1: 31.99%
[Test ] Loss: 1.4171 | Acc@1: 13.27%
[INFO] New best Acc@1: 13.27% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 29/30 | lr = 0.10000 ===
Epoch [29] Step [100/102] Loss: 1.0820 | Acc@1: 33.74%
[Train] Loss: 1.0812 | Acc@1: 33.79%
[Test ] Loss: 1.4295 | Acc@1: 14.06%
[INFO] New best Acc@1: 14.06% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 30/30 | lr = 0.10000 ===
Epoch [30] Step [100/102] Loss: 1.0614 | Acc@1: 35.17%
[Train] Loss: 1.0613 | Acc@1: 35.14%
[Test ] Loss: 1.4443 | Acc@1: 14.71%
[INFO] New best Acc@1: 14.71% → checkpoint saved to ckpt_asl_balanced_gen.pth

[RESULT] Best Test Acc@1: 14.71%

[INFO] Loading best checkpoint for group-wise evaluation...

[Group-wise Evaluation]
  total  | Acc:  14.71% | Micro-F1:  14.71% | Macro-F1:  13.52%
  head   | Acc:  10.37% | Micro-F1:  12.27% | Macro-F1:   9.79%
  medium | Acc:  20.13% | Micro-F1:  19.69% | Macro-F1:  18.76%
  tail   | Acc:  15.07% | Micro-F1:  12.73% | Macro-F1:  13.25%

[RESULT] Best Test Acc@1: 14.71%
