[INFO] Using device: cuda
[INFO] data_dir   = data/CIFAR100_LT
[INFO] train_txt  = ./data_txt/CIFAR100_LT/CIFAR100_LT_train.txt
[INFO] test_txt   = ./data_txt/CIFAR100_LT/CIFAR100_LT_test.txt
[INFO] use_generated = True
[INFO] gen_dir    = data/CIFAR100_LT/gen_train
[INFO] loss       = ce
[INFO] save_path  = ckpt_ce_balanced_gen.pth
[INFO] Using generated data: base=10847, gen=2176, total=13023
[INFO] #train=13023, #test=10000
[INFO] #classes=100
[INFO] cls_num_list (first 10): [536, 543, 512, 485, 466, 449, 438, 415, 404, 375]
[HMT] head   : 0 ~ 39  (#=40)
[HMT] medium : 40 ~ 69  (#=30)
[HMT] tail   : 70 ~ 99  (#=30)

=== Epoch 1/30 | lr = 0.10000 ===
Epoch [1] Step [100/102] Loss: 4.3339 | Acc@1: 5.65%
[Train] Loss: 4.3279 | Acc@1: 5.67%
[Test ] Loss: 4.1391 | Acc@1: 6.67%
[INFO] New best Acc@1: 6.67% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 2/30 | lr = 0.10000 ===
Epoch [2] Step [100/102] Loss: 3.8111 | Acc@1: 11.55%
[Train] Loss: 3.8095 | Acc@1: 11.56%
[Test ] Loss: 4.1160 | Acc@1: 7.85%
[INFO] New best Acc@1: 7.85% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 3/30 | lr = 0.10000 ===
Epoch [3] Step [100/102] Loss: 3.6000 | Acc@1: 16.05%
[Train] Loss: 3.5970 | Acc@1: 16.15%
[Test ] Loss: 4.0799 | Acc@1: 8.91%
[INFO] New best Acc@1: 8.91% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 4/30 | lr = 0.10000 ===
Epoch [4] Step [100/102] Loss: 3.3914 | Acc@1: 20.23%
[Train] Loss: 3.3905 | Acc@1: 20.26%
[Test ] Loss: 4.1554 | Acc@1: 10.90%
[INFO] New best Acc@1: 10.90% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 5/30 | lr = 0.10000 ===
Epoch [5] Step [100/102] Loss: 3.2436 | Acc@1: 23.53%
[Train] Loss: 3.2414 | Acc@1: 23.52%
[Test ] Loss: 4.1036 | Acc@1: 11.77%
[INFO] New best Acc@1: 11.77% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 6/30 | lr = 0.10000 ===
Epoch [6] Step [100/102] Loss: 3.0547 | Acc@1: 27.44%
[Train] Loss: 3.0536 | Acc@1: 27.51%
[Test ] Loss: 4.2570 | Acc@1: 11.56%

=== Epoch 7/30 | lr = 0.10000 ===
Epoch [7] Step [100/102] Loss: 2.8933 | Acc@1: 31.26%
[Train] Loss: 2.8909 | Acc@1: 31.31%
[Test ] Loss: 4.1571 | Acc@1: 13.63%
[INFO] New best Acc@1: 13.63% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 8/30 | lr = 0.10000 ===
Epoch [8] Step [100/102] Loss: 2.7484 | Acc@1: 34.47%
[Train] Loss: 2.7495 | Acc@1: 34.42%
[Test ] Loss: 4.2006 | Acc@1: 13.69%
[INFO] New best Acc@1: 13.69% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 9/30 | lr = 0.10000 ===
Epoch [9] Step [100/102] Loss: 2.6398 | Acc@1: 36.70%
[Train] Loss: 2.6398 | Acc@1: 36.76%
[Test ] Loss: 4.2308 | Acc@1: 13.31%

=== Epoch 10/30 | lr = 0.10000 ===
Epoch [10] Step [100/102] Loss: 2.5160 | Acc@1: 39.31%
[Train] Loss: 2.5170 | Acc@1: 39.24%
[Test ] Loss: 4.2751 | Acc@1: 15.20%
[INFO] New best Acc@1: 15.20% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 11/30 | lr = 0.10000 ===
Epoch [11] Step [100/102] Loss: 2.4584 | Acc@1: 40.51%
[Train] Loss: 2.4565 | Acc@1: 40.51%
[Test ] Loss: 4.2836 | Acc@1: 15.55%
[INFO] New best Acc@1: 15.55% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 12/30 | lr = 0.10000 ===
Epoch [12] Step [100/102] Loss: 2.3727 | Acc@1: 42.66%
[Train] Loss: 2.3687 | Acc@1: 42.77%
[Test ] Loss: 4.3039 | Acc@1: 16.52%
[INFO] New best Acc@1: 16.52% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 13/30 | lr = 0.10000 ===
Epoch [13] Step [100/102] Loss: 2.2545 | Acc@1: 45.00%
[Train] Loss: 2.2588 | Acc@1: 44.91%
[Test ] Loss: 4.2956 | Acc@1: 16.68%
[INFO] New best Acc@1: 16.68% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 14/30 | lr = 0.10000 ===
Epoch [14] Step [100/102] Loss: 2.1821 | Acc@1: 46.56%
[Train] Loss: 2.1779 | Acc@1: 46.67%
[Test ] Loss: 4.1622 | Acc@1: 17.44%
[INFO] New best Acc@1: 17.44% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 15/30 | lr = 0.10000 ===
Epoch [15] Step [100/102] Loss: 2.1011 | Acc@1: 48.36%
[Train] Loss: 2.1053 | Acc@1: 48.31%
[Test ] Loss: 4.4023 | Acc@1: 16.16%

=== Epoch 16/30 | lr = 0.10000 ===
Epoch [16] Step [100/102] Loss: 2.0522 | Acc@1: 49.68%
[Train] Loss: 2.0505 | Acc@1: 49.73%
[Test ] Loss: 4.3518 | Acc@1: 17.39%

=== Epoch 17/30 | lr = 0.10000 ===
Epoch [17] Step [100/102] Loss: 2.0167 | Acc@1: 50.30%
[Train] Loss: 2.0147 | Acc@1: 50.39%
[Test ] Loss: 4.2074 | Acc@1: 17.34%

=== Epoch 18/30 | lr = 0.10000 ===
Epoch [18] Step [100/102] Loss: 1.9470 | Acc@1: 52.22%
[Train] Loss: 1.9475 | Acc@1: 52.20%
[Test ] Loss: 4.3736 | Acc@1: 16.96%

=== Epoch 19/30 | lr = 0.10000 ===
Epoch [19] Step [100/102] Loss: 1.8940 | Acc@1: 53.38%
[Train] Loss: 1.8926 | Acc@1: 53.46%
[Test ] Loss: 4.4501 | Acc@1: 18.58%
[INFO] New best Acc@1: 18.58% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 20/30 | lr = 0.10000 ===
Epoch [20] Step [100/102] Loss: 1.8337 | Acc@1: 54.78%
[Train] Loss: 1.8309 | Acc@1: 54.89%
[Test ] Loss: 4.4685 | Acc@1: 17.95%

=== Epoch 21/30 | lr = 0.10000 ===
Epoch [21] Step [100/102] Loss: 1.8206 | Acc@1: 54.73%
[Train] Loss: 1.8200 | Acc@1: 54.76%
[Test ] Loss: 4.3526 | Acc@1: 18.59%
[INFO] New best Acc@1: 18.59% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 22/30 | lr = 0.10000 ===
Epoch [22] Step [100/102] Loss: 1.7538 | Acc@1: 56.33%
[Train] Loss: 1.7562 | Acc@1: 56.29%
[Test ] Loss: 4.2633 | Acc@1: 19.10%
[INFO] New best Acc@1: 19.10% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 23/30 | lr = 0.10000 ===
Epoch [23] Step [100/102] Loss: 1.7202 | Acc@1: 57.38%
[Train] Loss: 1.7184 | Acc@1: 57.41%
[Test ] Loss: 4.4483 | Acc@1: 18.66%

=== Epoch 24/30 | lr = 0.10000 ===
Epoch [24] Step [100/102] Loss: 1.6788 | Acc@1: 58.08%
[Train] Loss: 1.6765 | Acc@1: 58.14%
[Test ] Loss: 4.5829 | Acc@1: 18.14%

=== Epoch 25/30 | lr = 0.10000 ===
Epoch [25] Step [100/102] Loss: 1.6939 | Acc@1: 57.88%
[Train] Loss: 1.6910 | Acc@1: 57.93%
[Test ] Loss: 4.4798 | Acc@1: 19.20%
[INFO] New best Acc@1: 19.20% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 26/30 | lr = 0.10000 ===
Epoch [26] Step [100/102] Loss: 1.6274 | Acc@1: 59.31%
[Train] Loss: 1.6262 | Acc@1: 59.27%
[Test ] Loss: 4.5208 | Acc@1: 18.80%

=== Epoch 27/30 | lr = 0.10000 ===
Epoch [27] Step [100/102] Loss: 1.6182 | Acc@1: 59.57%
[Train] Loss: 1.6153 | Acc@1: 59.63%
[Test ] Loss: 4.3737 | Acc@1: 19.61%
[INFO] New best Acc@1: 19.61% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 28/30 | lr = 0.10000 ===
Epoch [28] Step [100/102] Loss: 1.6374 | Acc@1: 59.04%
[Train] Loss: 1.6380 | Acc@1: 59.02%
[Test ] Loss: 4.4460 | Acc@1: 19.82%
[INFO] New best Acc@1: 19.82% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 29/30 | lr = 0.10000 ===
Epoch [29] Step [100/102] Loss: 1.5702 | Acc@1: 60.94%
[Train] Loss: 1.5704 | Acc@1: 60.92%
[Test ] Loss: 4.2902 | Acc@1: 20.93%
[INFO] New best Acc@1: 20.93% → checkpoint saved to ckpt_ce_balanced_gen.pth

=== Epoch 30/30 | lr = 0.10000 ===
Epoch [30] Step [100/102] Loss: 1.5139 | Acc@1: 61.97%
[Train] Loss: 1.5166 | Acc@1: 61.94%
[Test ] Loss: 4.2654 | Acc@1: 20.13%

[RESULT] Best Test Acc@1: 20.93%

[INFO] Loading best checkpoint for group-wise evaluation...

[Group-wise Evaluation]
  total  | Acc:  20.93% | Micro-F1:  20.93% | Macro-F1:  19.19%
  head   | Acc:  26.97% | Micro-F1:  22.05% | Macro-F1:  21.43%
  medium | Acc:  25.03% | Micro-F1:  24.88% | Macro-F1:  24.24%
  tail   | Acc:   8.77% | Micro-F1:  12.59% | Macro-F1:  11.15%

[RESULT] Best Test Acc@1: 20.93%
