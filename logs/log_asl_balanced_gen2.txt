[INFO] Using device: cuda
[INFO] data_dir   = data/CIFAR100_LT
[INFO] train_txt  = ./data_txt/CIFAR100_LT/CIFAR100_LT_train.txt
[INFO] test_txt   = ./data_txt/CIFAR100_LT/CIFAR100_LT_test.txt
[INFO] use_generated = True
[INFO] gen_dir    = data/CIFAR100_LT/gen_train
[INFO] loss       = asl
[INFO] save_path  = ckpt_asl_balanced_gen.pth
[INFO] Using generated data: base=10847, gen=2176, total=13023
[INFO] #train=13023, #test=10000
[INFO] #classes=100
[INFO] cls_num_list (first 10): [536, 543, 512, 485, 466, 449, 438, 415, 404, 375]
[HMT] head   : 0 ~ 39  (#=40)
[HMT] medium : 40 ~ 69  (#=30)
[HMT] tail   : 70 ~ 99  (#=30)

=== Epoch 1/30 | lr = 0.10000 ===
Epoch [1] Step [100/102] Loss: 2.5710 | Acc@1: 3.51%
[Train] Loss: 2.5557 | Acc@1: 3.49%
[Test ] Loss: 1.6574 | Acc@1: 0.98%
[INFO] New best Acc@1: 0.98% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 2/30 | lr = 0.10000 ===
Epoch [2] Step [100/102] Loss: 1.7288 | Acc@1: 3.80%
[Train] Loss: 1.7264 | Acc@1: 3.79%
[Test ] Loss: 5.3224 | Acc@1: 1.13%
[INFO] New best Acc@1: 1.13% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 3/30 | lr = 0.10000 ===
Epoch [3] Step [100/102] Loss: 1.6526 | Acc@1: 4.43%
[Train] Loss: 1.6499 | Acc@1: 4.42%
[Test ] Loss: 1.6507 | Acc@1: 1.76%
[INFO] New best Acc@1: 1.76% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 4/30 | lr = 0.10000 ===
Epoch [4] Step [100/102] Loss: 1.3953 | Acc@1: 5.27%
[Train] Loss: 1.3942 | Acc@1: 5.31%
[Test ] Loss: 1.6496 | Acc@1: 1.83%
[INFO] New best Acc@1: 1.83% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 5/30 | lr = 0.10000 ===
Epoch [5] Step [100/102] Loss: 1.3354 | Acc@1: 6.14%
[Train] Loss: 1.3358 | Acc@1: 6.14%
[Test ] Loss: 1.6191 | Acc@1: 2.52%
[INFO] New best Acc@1: 2.52% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 6/30 | lr = 0.10000 ===
Epoch [6] Step [100/102] Loss: 1.3223 | Acc@1: 8.41%
[Train] Loss: 1.3225 | Acc@1: 8.44%
[Test ] Loss: 1.6096 | Acc@1: 3.34%
[INFO] New best Acc@1: 3.34% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 7/30 | lr = 0.10000 ===
Epoch [7] Step [100/102] Loss: 1.3073 | Acc@1: 9.02%
[Train] Loss: 1.3075 | Acc@1: 9.05%
[Test ] Loss: 1.6030 | Acc@1: 3.86%
[INFO] New best Acc@1: 3.86% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 8/30 | lr = 0.10000 ===
Epoch [8] Step [100/102] Loss: 1.2951 | Acc@1: 10.55%
[Train] Loss: 1.2952 | Acc@1: 10.55%
[Test ] Loss: 1.5722 | Acc@1: 4.62%
[INFO] New best Acc@1: 4.62% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 9/30 | lr = 0.10000 ===
Epoch [9] Step [100/102] Loss: 1.2821 | Acc@1: 11.26%
[Train] Loss: 1.2824 | Acc@1: 11.20%
[Test ] Loss: 1.5705 | Acc@1: 4.36%

=== Epoch 10/30 | lr = 0.10000 ===
Epoch [10] Step [100/102] Loss: 1.2762 | Acc@1: 11.73%
[Train] Loss: 1.2761 | Acc@1: 11.79%
[Test ] Loss: 1.5450 | Acc@1: 5.42%
[INFO] New best Acc@1: 5.42% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 11/30 | lr = 0.10000 ===
Epoch [11] Step [100/102] Loss: 1.2677 | Acc@1: 12.88%
[Train] Loss: 1.2679 | Acc@1: 12.90%
[Test ] Loss: 1.5473 | Acc@1: 5.58%
[INFO] New best Acc@1: 5.58% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 12/30 | lr = 0.10000 ===
Epoch [12] Step [100/102] Loss: 1.2587 | Acc@1: 13.98%
[Train] Loss: 1.2588 | Acc@1: 13.94%
[Test ] Loss: 1.5467 | Acc@1: 5.22%

=== Epoch 13/30 | lr = 0.10000 ===
Epoch [13] Step [100/102] Loss: 1.2500 | Acc@1: 15.30%
[Train] Loss: 1.2499 | Acc@1: 15.24%
[Test ] Loss: 1.5404 | Acc@1: 5.55%

=== Epoch 14/30 | lr = 0.10000 ===
Epoch [14] Step [100/102] Loss: 1.2438 | Acc@1: 15.27%
[Train] Loss: 1.2430 | Acc@1: 15.33%
[Test ] Loss: 1.5101 | Acc@1: 6.77%
[INFO] New best Acc@1: 6.77% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 15/30 | lr = 0.10000 ===
Epoch [15] Step [100/102] Loss: 1.2372 | Acc@1: 16.24%
[Train] Loss: 1.2372 | Acc@1: 16.24%
[Test ] Loss: 1.5125 | Acc@1: 6.88%
[INFO] New best Acc@1: 6.88% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 16/30 | lr = 0.10000 ===
Epoch [16] Step [100/102] Loss: 1.2266 | Acc@1: 17.34%
[Train] Loss: 1.2269 | Acc@1: 17.34%
[Test ] Loss: 1.5084 | Acc@1: 7.91%
[INFO] New best Acc@1: 7.91% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 17/30 | lr = 0.10000 ===
Epoch [17] Step [100/102] Loss: 1.2220 | Acc@1: 17.78%
[Train] Loss: 1.2222 | Acc@1: 17.77%
[Test ] Loss: 1.5210 | Acc@1: 7.47%

=== Epoch 18/30 | lr = 0.10000 ===
Epoch [18] Step [100/102] Loss: 1.2193 | Acc@1: 17.85%
[Train] Loss: 1.2191 | Acc@1: 17.88%
[Test ] Loss: 1.5301 | Acc@1: 7.78%

=== Epoch 19/30 | lr = 0.10000 ===
Epoch [19] Step [100/102] Loss: 1.2114 | Acc@1: 18.65%
[Train] Loss: 1.2110 | Acc@1: 18.71%
[Test ] Loss: 1.4999 | Acc@1: 8.32%
[INFO] New best Acc@1: 8.32% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 20/30 | lr = 0.10000 ===
Epoch [20] Step [100/102] Loss: 1.2078 | Acc@1: 18.98%
[Train] Loss: 1.2081 | Acc@1: 18.99%
[Test ] Loss: 1.4974 | Acc@1: 8.26%

=== Epoch 21/30 | lr = 0.10000 ===
Epoch [21] Step [100/102] Loss: 1.2001 | Acc@1: 20.11%
[Train] Loss: 1.2004 | Acc@1: 20.10%
[Test ] Loss: 1.4909 | Acc@1: 8.22%

=== Epoch 22/30 | lr = 0.10000 ===
Epoch [22] Step [100/102] Loss: 1.1942 | Acc@1: 20.51%
[Train] Loss: 1.1936 | Acc@1: 20.50%
[Test ] Loss: 1.4920 | Acc@1: 8.06%

=== Epoch 23/30 | lr = 0.10000 ===
Epoch [23] Step [100/102] Loss: 1.1888 | Acc@1: 20.74%
[Train] Loss: 1.1890 | Acc@1: 20.69%
[Test ] Loss: 1.5015 | Acc@1: 8.40%
[INFO] New best Acc@1: 8.40% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 24/30 | lr = 0.10000 ===
Epoch [24] Step [100/102] Loss: 1.1779 | Acc@1: 21.51%
[Train] Loss: 1.1784 | Acc@1: 21.45%
[Test ] Loss: 1.4854 | Acc@1: 8.65%
[INFO] New best Acc@1: 8.65% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 25/30 | lr = 0.10000 ===
Epoch [25] Step [100/102] Loss: 1.1786 | Acc@1: 22.09%
[Train] Loss: 1.1779 | Acc@1: 22.20%
[Test ] Loss: 1.4722 | Acc@1: 10.00%
[INFO] New best Acc@1: 10.00% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 26/30 | lr = 0.10000 ===
Epoch [26] Step [100/102] Loss: 1.1688 | Acc@1: 23.37%
[Train] Loss: 1.1680 | Acc@1: 23.38%
[Test ] Loss: 1.4807 | Acc@1: 10.08%
[INFO] New best Acc@1: 10.08% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 27/30 | lr = 0.10000 ===
Epoch [27] Step [100/102] Loss: 1.1628 | Acc@1: 23.42%
[Train] Loss: 1.1632 | Acc@1: 23.39%
[Test ] Loss: 1.4567 | Acc@1: 10.80%
[INFO] New best Acc@1: 10.80% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 28/30 | lr = 0.10000 ===
Epoch [28] Step [100/102] Loss: 1.1540 | Acc@1: 24.17%
[Train] Loss: 1.1545 | Acc@1: 24.16%
[Test ] Loss: 1.4412 | Acc@1: 11.80%
[INFO] New best Acc@1: 11.80% → checkpoint saved to ckpt_asl_balanced_gen.pth

=== Epoch 29/30 | lr = 0.10000 ===
Epoch [29] Step [100/102] Loss: 1.1477 | Acc@1: 24.57%
[Train] Loss: 1.1478 | Acc@1: 24.61%
[Test ] Loss: 1.4846 | Acc@1: 10.52%

=== Epoch 30/30 | lr = 0.10000 ===
Epoch [30] Step [100/102] Loss: 1.1398 | Acc@1: 25.77%
[Train] Loss: 1.1405 | Acc@1: 25.66%
[Test ] Loss: 1.4184 | Acc@1: 12.05%
[INFO] New best Acc@1: 12.05% → checkpoint saved to ckpt_asl_balanced_gen.pth

[RESULT] Best Test Acc@1: 12.05%

[INFO] Loading best checkpoint for group-wise evaluation...

[Group-wise Evaluation]
  total  | Acc:  12.05% | Micro-F1:  12.05% | Macro-F1:   7.01%
  head   | Acc:  27.35% | Micro-F1:  15.91% | Macro-F1:  13.53%
  medium | Acc:   3.70% | Micro-F1:   6.84% | Macro-F1:   5.31%
  tail   | Acc:   0.00% | Micro-F1:   0.00% | Macro-F1:   0.00%

[RESULT] Best Test Acc@1: 12.05%
