[INFO] Using device: cuda
[INFO] data_dir   = data/CIFAR100_LT
[INFO] train_txt  = ./data_txt/CIFAR100_LT/CIFAR100_LT_train.txt
[INFO] test_txt   = ./data_txt/CIFAR100_LT/CIFAR100_LT_test.txt
[INFO] use_generated = True
[INFO] gen_dir    = data/CIFAR100_LT/gen_train
[INFO] loss       = focal
[INFO] save_path  = ckpt_focal_balanced_gen.pth
[INFO] Using generated data: base=10847, gen=2176, total=13023
[INFO] #train=13023, #test=10000
[INFO] #classes=100
[INFO] cls_num_list (first 10): [536, 543, 512, 485, 466, 449, 438, 415, 404, 375]
[HMT] head   : 0 ~ 39  (#=40)
[HMT] medium : 40 ~ 69  (#=30)
[HMT] tail   : 70 ~ 99  (#=30)

=== Epoch 1/30 | lr = 0.10000 ===
Epoch [1] Step [100/102] Loss: 3.8876 | Acc@1: 7.84%
[Train] Loss: 3.8818 | Acc@1: 7.89%
[Test ] Loss: 5.2123 | Acc@1: 3.76%
[INFO] New best Acc@1: 3.76% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 2/30 | lr = 0.10000 ===
Epoch [2] Step [100/102] Loss: 3.4057 | Acc@1: 11.53%
[Train] Loss: 3.4040 | Acc@1: 11.64%
[Test ] Loss: 4.9659 | Acc@1: 4.49%
[INFO] New best Acc@1: 4.49% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 3/30 | lr = 0.10000 ===
Epoch [3] Step [100/102] Loss: 3.2833 | Acc@1: 14.42%
[Train] Loss: 3.2846 | Acc@1: 14.40%
[Test ] Loss: 4.7936 | Acc@1: 6.22%
[INFO] New best Acc@1: 6.22% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 4/30 | lr = 0.10000 ===
Epoch [4] Step [100/102] Loss: 3.1915 | Acc@1: 15.51%
[Train] Loss: 3.1910 | Acc@1: 15.50%
[Test ] Loss: 4.6662 | Acc@1: 7.34%
[INFO] New best Acc@1: 7.34% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 5/30 | lr = 0.10000 ===
Epoch [5] Step [100/102] Loss: 3.1043 | Acc@1: 17.23%
[Train] Loss: 3.1023 | Acc@1: 17.27%
[Test ] Loss: 4.6362 | Acc@1: 7.74%
[INFO] New best Acc@1: 7.74% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 6/30 | lr = 0.10000 ===
Epoch [6] Step [100/102] Loss: 3.0624 | Acc@1: 18.27%
[Train] Loss: 3.0616 | Acc@1: 18.26%
[Test ] Loss: 4.6376 | Acc@1: 8.39%
[INFO] New best Acc@1: 8.39% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 7/30 | lr = 0.10000 ===
Epoch [7] Step [100/102] Loss: 3.0011 | Acc@1: 19.25%
[Train] Loss: 3.0002 | Acc@1: 19.26%
[Test ] Loss: 4.5053 | Acc@1: 7.83%

=== Epoch 8/30 | lr = 0.10000 ===
Epoch [8] Step [100/102] Loss: 2.9398 | Acc@1: 20.12%
[Train] Loss: 2.9381 | Acc@1: 20.22%
[Test ] Loss: 4.4273 | Acc@1: 10.30%
[INFO] New best Acc@1: 10.30% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 9/30 | lr = 0.10000 ===
Epoch [9] Step [100/102] Loss: 2.8712 | Acc@1: 21.45%
[Train] Loss: 2.8706 | Acc@1: 21.44%
[Test ] Loss: 4.3466 | Acc@1: 11.29%
[INFO] New best Acc@1: 11.29% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 10/30 | lr = 0.10000 ===
Epoch [10] Step [100/102] Loss: 2.8108 | Acc@1: 22.83%
[Train] Loss: 2.8092 | Acc@1: 22.87%
[Test ] Loss: 4.4723 | Acc@1: 10.28%

=== Epoch 11/30 | lr = 0.10000 ===
Epoch [11] Step [100/102] Loss: 2.7354 | Acc@1: 24.01%
[Train] Loss: 2.7401 | Acc@1: 23.90%
[Test ] Loss: 4.2662 | Acc@1: 10.81%

=== Epoch 12/30 | lr = 0.10000 ===
Epoch [12] Step [100/102] Loss: 2.6808 | Acc@1: 24.66%
[Train] Loss: 2.6817 | Acc@1: 24.66%
[Test ] Loss: 4.1707 | Acc@1: 13.14%
[INFO] New best Acc@1: 13.14% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 13/30 | lr = 0.10000 ===
Epoch [13] Step [100/102] Loss: 2.6384 | Acc@1: 25.50%
[Train] Loss: 2.6361 | Acc@1: 25.55%
[Test ] Loss: 4.3392 | Acc@1: 11.79%

=== Epoch 14/30 | lr = 0.10000 ===
Epoch [14] Step [100/102] Loss: 2.5805 | Acc@1: 26.93%
[Train] Loss: 2.5828 | Acc@1: 26.91%
[Test ] Loss: 4.2008 | Acc@1: 13.05%

=== Epoch 15/30 | lr = 0.10000 ===
Epoch [15] Step [100/102] Loss: 2.5433 | Acc@1: 27.61%
[Train] Loss: 2.5401 | Acc@1: 27.68%
[Test ] Loss: 4.1453 | Acc@1: 14.28%
[INFO] New best Acc@1: 14.28% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 16/30 | lr = 0.10000 ===
Epoch [16] Step [100/102] Loss: 2.4732 | Acc@1: 28.70%
[Train] Loss: 2.4716 | Acc@1: 28.76%
[Test ] Loss: 4.1957 | Acc@1: 14.29%
[INFO] New best Acc@1: 14.29% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 17/30 | lr = 0.10000 ===
Epoch [17] Step [100/102] Loss: 2.4106 | Acc@1: 30.20%
[Train] Loss: 2.4124 | Acc@1: 30.11%
[Test ] Loss: 3.9642 | Acc@1: 15.30%
[INFO] New best Acc@1: 15.30% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 18/30 | lr = 0.10000 ===
Epoch [18] Step [100/102] Loss: 2.3675 | Acc@1: 30.79%
[Train] Loss: 2.3666 | Acc@1: 30.83%
[Test ] Loss: 4.0895 | Acc@1: 14.59%

=== Epoch 19/30 | lr = 0.10000 ===
Epoch [19] Step [100/102] Loss: 2.3140 | Acc@1: 32.26%
[Train] Loss: 2.3122 | Acc@1: 32.28%
[Test ] Loss: 4.0483 | Acc@1: 15.42%
[INFO] New best Acc@1: 15.42% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 20/30 | lr = 0.10000 ===
Epoch [20] Step [100/102] Loss: 2.2739 | Acc@1: 33.59%
[Train] Loss: 2.2755 | Acc@1: 33.59%
[Test ] Loss: 3.9777 | Acc@1: 16.36%
[INFO] New best Acc@1: 16.36% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 21/30 | lr = 0.10000 ===
Epoch [21] Step [100/102] Loss: 2.2077 | Acc@1: 34.20%
[Train] Loss: 2.2064 | Acc@1: 34.21%
[Test ] Loss: 3.8138 | Acc@1: 17.64%
[INFO] New best Acc@1: 17.64% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 22/30 | lr = 0.10000 ===
Epoch [22] Step [100/102] Loss: 2.1788 | Acc@1: 35.20%
[Train] Loss: 2.1783 | Acc@1: 35.15%
[Test ] Loss: 3.8197 | Acc@1: 17.85%
[INFO] New best Acc@1: 17.85% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 23/30 | lr = 0.10000 ===
Epoch [23] Step [100/102] Loss: 2.1257 | Acc@1: 36.13%
[Train] Loss: 2.1295 | Acc@1: 36.06%
[Test ] Loss: 4.1512 | Acc@1: 14.79%

=== Epoch 24/30 | lr = 0.10000 ===
Epoch [24] Step [100/102] Loss: 2.0814 | Acc@1: 37.07%
[Train] Loss: 2.0810 | Acc@1: 37.08%
[Test ] Loss: 3.9387 | Acc@1: 16.88%

=== Epoch 25/30 | lr = 0.10000 ===
Epoch [25] Step [100/102] Loss: 2.0623 | Acc@1: 37.61%
[Train] Loss: 2.0642 | Acc@1: 37.61%
[Test ] Loss: 3.8756 | Acc@1: 18.17%
[INFO] New best Acc@1: 18.17% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 26/30 | lr = 0.10000 ===
Epoch [26] Step [100/102] Loss: 1.9998 | Acc@1: 38.91%
[Train] Loss: 1.9959 | Acc@1: 39.01%
[Test ] Loss: 3.7497 | Acc@1: 19.62%
[INFO] New best Acc@1: 19.62% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 27/30 | lr = 0.10000 ===
Epoch [27] Step [100/102] Loss: 1.9538 | Acc@1: 40.18%
[Train] Loss: 1.9550 | Acc@1: 40.18%
[Test ] Loss: 3.6367 | Acc@1: 20.80%
[INFO] New best Acc@1: 20.80% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 28/30 | lr = 0.10000 ===
Epoch [28] Step [100/102] Loss: 1.9265 | Acc@1: 40.57%
[Train] Loss: 1.9265 | Acc@1: 40.57%
[Test ] Loss: 3.5746 | Acc@1: 22.39%
[INFO] New best Acc@1: 22.39% → checkpoint saved to ckpt_focal_balanced_gen.pth

=== Epoch 29/30 | lr = 0.10000 ===
Epoch [29] Step [100/102] Loss: 1.8827 | Acc@1: 41.76%
[Train] Loss: 1.8825 | Acc@1: 41.82%
[Test ] Loss: 3.6121 | Acc@1: 19.19%

=== Epoch 30/30 | lr = 0.10000 ===
Epoch [30] Step [100/102] Loss: 1.8479 | Acc@1: 42.71%
[Train] Loss: 1.8474 | Acc@1: 42.73%
[Test ] Loss: 3.8042 | Acc@1: 19.92%

[RESULT] Best Test Acc@1: 22.39%

[INFO] Loading best checkpoint for group-wise evaluation...

[Group-wise Evaluation]
  total  | Acc:  22.39% | Micro-F1:  22.39% | Macro-F1:  17.82%
  head   | Acc:  42.60% | Micro-F1:  26.33% | Macro-F1:  27.97%
  medium | Acc:  16.90% | Micro-F1:  25.29% | Macro-F1:  20.51%
  tail   | Acc:   0.93% | Micro-F1:   1.84% | Macro-F1:   1.61%

[RESULT] Best Test Acc@1: 22.39%
